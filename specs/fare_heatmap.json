{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "description": "Fare matrix heatmap with interactive origin/destination filters and fare threshold.",
  "autosize": {
    "type": "fit",
    "contains": "padding"
  },
  "width": "container",
  "height": {
    "step": 10
  },
  "data": {
    "url": "data/fare_long.csv"
  },
  "params": [
    {
      "name": "OriginFilter",
      "value": "All",
      "bind": {
        "input": "select",
        "name": "Origin: ",
        "options": [
          "All",
          "Gombak",
          "Taman Melati",
          "Wangsa Maju",
          "Sri Rampai",
          "Setiawangsa",
          "Jelatek",
          "Dato' Keramat",
          "Damai",
          "Ampang Park",
          "KLCC",
          "Kampung Baru",
          "Dang Wangi",
          "Masjid Jamek (KJL)",
          "Pasar Seni (KJL)",
          "KL Sentral (KJL)",
          "Bangsar",
          "Abdullah Hukum",
          "Kerinchi",
          "Universiti",
          "Taman Jaya",
          "Asia Jaya",
          "Taman Paramount",
          "Taman Bahagia",
          "Kelana Jaya",
          "Lembah Subang",
          "Ara Damansara",
          "Glenmarie",
          "Subang Jaya",
          "SS 15",
          "SS 18",
          "USJ 7 (KJL)",
          "Taipan",
          "Wawasan",
          "USJ 21",
          "Alam Megah",
          "Subang Alam",
          "Putra Heights (KJL)",
          "Sungai Buloh",
          "Kampung Selamat",
          "Kwasa Damansara",
          "Kwasa Sentral",
          "Kota Damansara",
          "Surian",
          "Mutiara Damansara",
          "Bandar Utama",
          "TTDI",
          "Phileo Damansara",
          "Pusat Bandar Damansara",
          "Semantan",
          "Muzium Negara",
          "Pasar Seni (SBK)",
          "Merdeka",
          "Bukit Bintang",
          "Tun Razak Exchange (TRX)",
          "Cochrane",
          "Maluri (SBK)",
          "Taman Pertama",
          "Taman Midah",
          "Taman Mutiara",
          "Taman Connaught",
          "Taman Suntex",
          "Sri Raya",
          "Bandar Tun Hussein Onn",
          "Batu 11 Cheras",
          "Bukit Dukung",
          "Sungai Jernih",
          "Stadium Kajang",
          "Kajang"
        ]
      }
    },
    {
      "name": "DestinationFilter",
      "value": "All",
      "bind": {
        "input": "select",
        "name": "Destination: ",
        "options": [
          "All",
          "Gombak",
          "Taman Melati",
          "Wangsa Maju",
          "Sri Rampai",
          "Setiawangsa",
          "Jelatek",
          "Dato' Keramat",
          "Damai",
          "Ampang Park",
          "KLCC",
          "Kampung Baru",
          "Dang Wangi",
          "Masjid Jamek (KJL)",
          "Pasar Seni (KJL)",
          "KL Sentral (KJL)",
          "Bangsar",
          "Abdullah Hukum",
          "Kerinchi",
          "Universiti",
          "Taman Jaya",
          "Asia Jaya",
          "Taman Paramount",
          "Taman Bahagia",
          "Kelana Jaya",
          "Lembah Subang",
          "Ara Damansara",
          "Glenmarie",
          "Subang Jaya",
          "SS 15",
          "SS 18",
          "USJ 7 (KJL)",
          "Taipan",
          "Wawasan",
          "USJ 21",
          "Alam Megah",
          "Subang Alam",
          "Putra Heights (KJL)",
          "Sungai Buloh",
          "Kampung Selamat",
          "Kwasa Damansara",
          "Kwasa Sentral",
          "Kota Damansara",
          "Surian",
          "Mutiara Damansara",
          "Bandar Utama",
          "TTDI",
          "Phileo Damansara",
          "Pusat Bandar Damansara",
          "Semantan",
          "Muzium Negara",
          "Pasar Seni (SBK)",
          "Merdeka",
          "Bukit Bintang",
          "Tun Razak Exchange (TRX)",
          "Cochrane",
          "Maluri (SBK)",
          "Taman Pertama",
          "Taman Midah",
          "Taman Mutiara",
          "Taman Connaught",
          "Taman Suntex",
          "Sri Raya",
          "Bandar Tun Hussein Onn",
          "Batu 11 Cheras",
          "Bukit Dukung",
          "Sungai Jernih",
          "Stadium Kajang",
          "Kajang"
        ]
      }
    },
    {
      "name": "FareMax",
      "value": 7.5,
      "bind": {
        "input": "range",
        "name": "Max fare (RM): ",
        "min": 1.8,
        "max": 7.5,
        "step": 0.1
      }
    },
    {
      "name": "CellHover",
      "value": null,
      "select": {
        "type": "point",
        "fields": [
          "origin",
          "destination"
        ]
      },
      "on": "pointerover",
      "clear": "pointerout"
    }
  ],
  "transform": [
    {
      "filter": "datum.origin !== datum.destination"
    },
    {
      "filter": "OriginFilter === 'All' || datum.origin === OriginFilter"
    },
    {
      "filter": "DestinationFilter === 'All' || datum.destination === DestinationFilter"
    },
    {
      "filter": "datum.fare <= FareMax"
    }
  ],
  "mark": {
    "type": "rect",
    "cornerRadius": 2
  },
  "encoding": {
    "x": {
      "field": "destination",
      "type": "ordinal",
      "title": "Destination station",
      "sort": [
        "Gombak",
        "Taman Melati",
        "Wangsa Maju",
        "Sri Rampai",
        "Setiawangsa",
        "Jelatek",
        "Dato' Keramat",
        "Damai",
        "Ampang Park",
        "KLCC",
        "Kampung Baru",
        "Dang Wangi",
        "Masjid Jamek (KJL)",
        "Pasar Seni (KJL)",
        "KL Sentral (KJL)",
        "Bangsar",
        "Abdullah Hukum",
        "Kerinchi",
        "Universiti",
        "Taman Jaya",
        "Asia Jaya",
        "Taman Paramount",
        "Taman Bahagia",
        "Kelana Jaya",
        "Lembah Subang",
        "Ara Damansara",
        "Glenmarie",
        "Subang Jaya",
        "SS 15",
        "SS 18",
        "USJ 7 (KJL)",
        "Taipan",
        "Wawasan",
        "USJ 21",
        "Alam Megah",
        "Subang Alam",
        "Putra Heights (KJL)",
        "Sungai Buloh",
        "Kampung Selamat",
        "Kwasa Damansara",
        "Kwasa Sentral",
        "Kota Damansara",
        "Surian",
        "Mutiara Damansara",
        "Bandar Utama",
        "TTDI",
        "Phileo Damansara",
        "Pusat Bandar Damansara",
        "Semantan",
        "Muzium Negara",
        "Pasar Seni (SBK)",
        "Merdeka",
        "Bukit Bintang",
        "Tun Razak Exchange (TRX)",
        "Cochrane",
        "Maluri (SBK)",
        "Taman Pertama",
        "Taman Midah",
        "Taman Mutiara",
        "Taman Connaught",
        "Taman Suntex",
        "Sri Raya",
        "Bandar Tun Hussein Onn",
        "Batu 11 Cheras",
        "Bukit Dukung",
        "Sungai Jernih",
        "Stadium Kajang",
        "Kajang"
      ]
    },
    "y": {
      "field": "origin",
      "type": "ordinal",
      "title": "Origin station",
      "sort": [
        "Gombak",
        "Taman Melati",
        "Wangsa Maju",
        "Sri Rampai",
        "Setiawangsa",
        "Jelatek",
        "Dato' Keramat",
        "Damai",
        "Ampang Park",
        "KLCC",
        "Kampung Baru",
        "Dang Wangi",
        "Masjid Jamek (KJL)",
        "Pasar Seni (KJL)",
        "KL Sentral (KJL)",
        "Bangsar",
        "Abdullah Hukum",
        "Kerinchi",
        "Universiti",
        "Taman Jaya",
        "Asia Jaya",
        "Taman Paramount",
        "Taman Bahagia",
        "Kelana Jaya",
        "Lembah Subang",
        "Ara Damansara",
        "Glenmarie",
        "Subang Jaya",
        "SS 15",
        "SS 18",
        "USJ 7 (KJL)",
        "Taipan",
        "Wawasan",
        "USJ 21",
        "Alam Megah",
        "Subang Alam",
        "Putra Heights (KJL)",
        "Sungai Buloh",
        "Kampung Selamat",
        "Kwasa Damansara",
        "Kwasa Sentral",
        "Kota Damansara",
        "Surian",
        "Mutiara Damansara",
        "Bandar Utama",
        "TTDI",
        "Phileo Damansara",
        "Pusat Bandar Damansara",
        "Semantan",
        "Muzium Negara",
        "Pasar Seni (SBK)",
        "Merdeka",
        "Bukit Bintang",
        "Tun Razak Exchange (TRX)",
        "Cochrane",
        "Maluri (SBK)",
        "Taman Pertama",
        "Taman Midah",
        "Taman Mutiara",
        "Taman Connaught",
        "Taman Suntex",
        "Sri Raya",
        "Bandar Tun Hussein Onn",
        "Batu 11 Cheras",
        "Bukit Dukung",
        "Sungai Jernih",
        "Stadium Kajang",
        "Kajang"
      ]
    },
    "color": {
      "field": "fare",
      "type": "quantitative",
      "title": "Fare (RM)",
      "scale": {
        "scheme": "viridis"
      }
    },
    "opacity": {
      "condition": {
        "param": "CellHover",
        "empty": false,
        "value": 1.0
      },
      "value": 0.85
    },
    "tooltip": [
      {
        "field": "origin",
        "title": "Origin"
      },
      {
        "field": "destination",
        "title": "Destination"
      },
      {
        "field": "fare",
        "type": "quantitative",
        "format": ".2f",
        "title": "Fare (RM)"
      }
    ]
  },
  "config": {
    "view": {
      "stroke": null
    },
    "axis": {
      "labelFontSize": 10,
      "labelColor": "#424242"
    }
  }
}
